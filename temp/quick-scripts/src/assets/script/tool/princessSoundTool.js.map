{"version":3,"sources":["assets/script/tool/princessSoundTool.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["//音频工具类\r\n\r\nimport { princessStorage } from \"./princessStorage\";\r\n\r\n\r\nconst commonBtnPath = \"sound/click\";\r\nconst commonBgmPath = \"sound/bgm\";\r\n\r\nexport class princessSoundTool {\r\n     \r\n    musicSwitch: boolean;    //背景音乐开关\r\n    effectSwitch: boolean;   //音效开关\r\n    shockSwitch: boolean;    // 震动开关   \r\n\r\n    private btnClickEffect: cc.AudioClip = null;\r\n    private bgmMusic: cc.AudioClip = null;\r\n\r\n    private currMusic: cc.AudioClip = null;\r\n\r\n    public initBtnClickEffect(): void {\r\n        if (this.btnClickEffect) return;\r\n\r\n        cc.resources.load(commonBtnPath, cc.AudioClip, (err: Error, clip: cc.AudioClip) => {\r\n            if (err || !cc.isValid(this)) {\r\n                return;\r\n            }\r\n            this.btnClickEffect = clip;\r\n            clip.addRef();\r\n        });\r\n    }\r\n\r\n    public initbgmMusic(): void {\r\n        if (this.bgmMusic) return;\r\n\r\n        cc.resources.load(commonBgmPath, cc.AudioClip, (err: Error, clip: cc.AudioClip) => {\r\n            if (err || !cc.isValid(this)) {\r\n                return;\r\n            }\r\n            this.bgmMusic = clip;\r\n            this.commonbgmMusic();\r\n            clip.addRef();\r\n        });\r\n    }\r\n\r\n    constructor() {\r\n        this.musicSwitch = princessStorage.getBoolByKey(\"kk_setup_music\", true);\r\n        this.effectSwitch = princessStorage.getBoolByKey(\"kk_setup_effect\", true);\r\n        this.shockSwitch = princessStorage.getBoolByKey(\"kk_setup_shock\", true);\r\n    }\r\n\r\n    public switchMusic(): void {\r\n        this.musicSwitch = !this.musicSwitch;\r\n        princessStorage.setBoolByKey(\"kk_setup_music\", this.musicSwitch);\r\n        if (this.musicSwitch) {\r\n            if (this.currMusic) {\r\n                this.playMusic(this.currMusic);\r\n            }\r\n        } else {\r\n            this.stopMusic();\r\n        }\r\n    }\r\n\r\n    public switchEffect(): void {\r\n        this.effectSwitch = !this.effectSwitch;\r\n        princessStorage.setBoolByKey(\"kk_setup_effect\", this.effectSwitch);\r\n        if (this.effectSwitch) {\r\n\r\n        } else {\r\n            cc.audioEngine.stopAllEffects();\r\n        }\r\n    }\r\n\r\n    public switchShock(): void {\r\n        this.shockSwitch = !this.shockSwitch;\r\n        princessStorage.setBoolByKey(\"kk_setup_shock\", this.shockSwitch);\r\n    }\r\n\r\n\r\n    public playMusic(audio: cc.AudioClip, isLoop: boolean = true): void {\r\n        if (!audio) return;\r\n        this.currMusic = audio;//保存当前背景音乐\r\n        if (this.musicSwitch) {\r\n            // this.stopMusic();\r\n            var audioID = cc.audioEngine.playMusic(audio, isLoop);\r\n        }\r\n    }\r\n\r\n    public playEffect(audio: cc.AudioClip, isLoop: boolean = false, callback: Function = null): number {\r\n        if (!audio) return;\r\n        if (this.effectSwitch) {\r\n            var audioID = cc.audioEngine.play(audio, isLoop, 1);\r\n            if (callback) cc.audioEngine.setFinishCallback(audioID, callback);\r\n            return audioID;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public playEffectWithPath(path: string, isLoop: boolean = false): void {\r\n        if (!path || !this.effectSwitch) return;\r\n        cc.resources.load(path, cc.AudioClip, (err: Error, clip: cc.AudioClip) => {\r\n            if (err) {\r\n                cc.log(\"加载音效资源失败\" + path);\r\n                return;\r\n            }\r\n            var audioID = cc.audioEngine.play(clip, isLoop, 1);\r\n        });\r\n    }\r\n\r\n\r\n    public stopMusic(): void {\r\n        cc.audioEngine.stopMusic();\r\n    }\r\n\r\n\r\n    public stopAll(): void {\r\n        cc.audioEngine.stopAll();\r\n    }\r\n\r\n    public pauseAll(): void {\r\n        if (this.musicSwitch) {\r\n            cc.audioEngine.pauseAll();\r\n        }\r\n    }\r\n\r\n\r\n    public resumeAll(): void {\r\n        if (this.musicSwitch) {\r\n            cc.audioEngine.resumeAll();\r\n        }\r\n    }\r\n\r\n\r\n    public stopEffect(audioID: number): void {\r\n        cc.audioEngine.stopEffect(audioID);\r\n    }\r\n\r\n\r\n    public pause(audioID: number): void {\r\n        cc.audioEngine.pause(audioID);\r\n    }\r\n\r\n\r\n    public resume(audioID: number): void {\r\n        if (this.musicSwitch) {\r\n            cc.audioEngine.resume(audioID);\r\n        }\r\n    }\r\n\r\n    public commonBtnClick(): void {\r\n        this.playEffect(this.btnClickEffect, false);\r\n    }\r\n\r\n    public commonbgmMusic(): void {\r\n        this.playMusic(this.bgmMusic);\r\n    }\r\n\r\n\r\n}\r\n"]}